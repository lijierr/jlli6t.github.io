---
layout: post
title: 测序质量值计算及换算
description:
author: Jie Li
date: 2020-04-02
categories: [bioinformatics, sequencing]
tags: [sequencing]
lang: zh-CN
math: true
---

序列格式分为两种：`fasta`和`fastq`。测序碱基的质量值即存储在`fastq`格式的每第四行，用`ASCII`码表示。

高通量测序发展后，测序服务得到了极大的推广，两种不同测序质量体系之间的转换，不知道之前有没有别的人研究过，我记得好像有人是直接用`ASCII`值减去质量体系然后再加上新的质量体系的值，形成新的`ASCII`值存回`fastq`文件中，这样的做法其实是不准确的，在测序质量很好的时候几乎没有差别，但是在测序质量相对较差的区域（例如`P>0.2`），两者差得比较明显，但其实依然没有统计学差异。虽然没有统计学差异，但是人为引入了误差，这样不好。

`Sanger`家的`Q`值计算公式：

$$ Q = -10 * \log \left( \rho \right) $$

`Solexa`家的`Q`值计算公式：

$$ Q = -10 * \log \left( \frac{\rho}{1-\rho} \right) $$

从公式可以看到这个差别，具体图形化就是。


测序质量值与碱基检出精确度的关系

| 质量分值 | 碱基的错误检出率 | 推断的碱基检出精确度 |
| :-----: | :-----------: | :---------------: |
| 10(Q10) |      1/10     |        90%        |
| 20(Q20) |     1/100     |        99%        |
| 30(Q30) |    1/1000     |        99.9%      |
| 40(Q40) |   1/10000     |        99.99%     |
| 50(Q50) |  1/100000     |        99.999%    |
